<!--_______________________________________________________________________________________________________________________
	Name:			LCFGrantHistory.page
	Description:	Access to LCF Grant History Blocks
					
	Date         Version Author      		Summary of Changes  
	___________  _______ _________________	________________________________________________________________________________
	May 2018     1.0     Michael Witchalls	Initial Release 
________________________________________________________________________________________________________________________ -->  
<apex:page controller="LCFGrantHistoryController" standardStylesheets="false" showHeader="false">
	<apex:composition template="Layout">
		<apex:define name="title"> 
		    <title>LCF Grant History</title> 
		</apex:define>
		<apex:define name="breadcrumbs">
		</apex:define>
		<apex:define name="mainFullWidth">
			
			<div class="grid-row">
				<div class="column-two-thirds">
               		<h1 class="heading-large">{!form.title} history</h1>
                </div>
                <div class="column-third">
					<aside class="govuk-related-items" role="complementary">
        				<h2 class="heading-medium" id="subsection-title">Navigation Links</h2>
       					<nav role="navigation" aria-labelledby="subsection-title">
						<ul class="font-small">
				            <li>
				            <apex:outputLink value="/officeusers">
							    Home
							</apex:outputLink> 
							</li>
				            <li>
				            <apex:outputLink value="{!$Page.Applications}">
							    Applications
							    <apex:param name="id" value="{!idString}"/>				    
							</apex:outputLink>
							</li>
				            <li>
				            <apex:outputLink value="{!$Page.LCFGrants}">
							    Grant Management
							    <apex:param name="id" value="{!idString}"/>				    
							</apex:outputLink>
							</li>
						</ul>
				        </nav>
      				</aside>                
      			</div>
            </div>
            <div class="grid-row">
				<div class="column-two-thirds">
                	<table class="applications">
						<thead>
							<tr>
							<apex:repeat value="{!fieldHeaders}" var="fhead">
								<th scope="col">{!fhead}</th>
							</apex:repeat>
							</tr>
						</thead>
						<tbody>
							<apex:variable var="nr" value="{!1}"/>
							<apex:repeat value="{!records}" var="rec">
								<tr>
    							<apex:variable var="nc" value="{!1}"/>
								<apex:repeat value="{!rec.values}" var="val">
									<td scope="row" class="app-identifier">
										<apex:outputText rendered="{!AND(nc<rec.valueCount,OR(nr==1,nc>1))}"> 
										{!val}
										</apex:outputText>
										<apex:outputLink value="{!$Page.LCFGrantBlock}" rendered="{!nc==rec.valueCount}"> 
										    {!val}
										    <apex:param name="form" value="{!form.id}"/>
										    <apex:param name="app" value="{!rec.obj['lcf_grant__r.Application_ID__c']}"/>
										    <apex:param name="grant" value="{!rec.obj['lcf_grant__r.Name']}"/>
										    <apex:param name="id" value="{!rec.obj['Name']}"/>
										</apex:outputLink>
									</td>
									<apex:variable var="nc" value="{!nc + 1}"/>
								</apex:repeat>
								</tr>
								<apex:variable var="nr" value="{!nr + 1}"/>
							</apex:repeat>
						</tbody>
					</table>

				</div>
			</div>

		</apex:define>
	</apex:composition>
</apex:page>